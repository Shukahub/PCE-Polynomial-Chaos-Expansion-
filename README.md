# PCEç¥ç»ç½‘ç»œæ›¿ä»£æ–¹æ¡ˆ (Polynomial Chaos Expansion)

è¿™æ˜¯ä¸€ä¸ªå®Œæ•´çš„PCEï¼ˆå¤šé¡¹å¼æ··æ²Œå±•å¼€ï¼‰å®ç°ï¼Œç”¨äºæ›¿ä»£ç¥ç»ç½‘ç»œè¿›è¡Œå¿«é€Ÿæ¨ç†ã€‚PCEç‰¹åˆ«é€‚ç”¨äºéœ€è¦é«˜é€Ÿæ¨ç†çš„åº”ç”¨åœºæ™¯ï¼Œå¦‚å®æ—¶ç³»ç»Ÿã€åµŒå…¥å¼è®¾å¤‡ç­‰ã€‚

## ğŸš€ ç‰¹æ€§

- **é«˜é€Ÿæ¨ç†**: PCEæ¨ç†é€Ÿåº¦æ¯”ç¥ç»ç½‘ç»œå¿«5-50å€
- **å†…å­˜æ•ˆç‡**: åªéœ€å­˜å‚¨å¤šé¡¹å¼ç³»æ•°ï¼Œå†…å­˜å ç”¨æå°
- **æ•°å­¦å¯è§£é‡Šæ€§**: åŸºäºå¤šé¡¹å¼å±•å¼€ï¼Œå…·æœ‰æ˜ç¡®çš„æ•°å­¦æ„ä¹‰
- **æ˜“äºéƒ¨ç½²**: å¯ç›´æ¥åµŒå…¥åˆ°Fortran/C/C++ä»£ç ä¸­
- **æ— éœ€æ·±åº¦å­¦ä¹ æ¡†æ¶**: æ¨ç†æ—¶ä¸ä¾èµ–ä»»ä½•æ·±åº¦å­¦ä¹ åº“

## ğŸ“ æ–‡ä»¶ç»“æ„

```
â”œâ”€â”€ PCE.for                    # Fortran PCEæ¨ç†ç¨‹åº
â”œâ”€â”€ pce_trainer.py            # Python PCEè®­ç»ƒå™¨
â”œâ”€â”€ data_generator.py         # è®­ç»ƒæ•°æ®ç”Ÿæˆå™¨
â”œâ”€â”€ pce_demo.py              # PCE vs ç¥ç»ç½‘ç»œæ€§èƒ½å¯¹æ¯”
â”œâ”€â”€ Makefile                 # Fortranç¼–è¯‘é…ç½®
â”œâ”€â”€ README.md               # æœ¬æ–‡æ¡£
â””â”€â”€ requirements.txt        # Pythonä¾èµ–
```

## ğŸ› ï¸ å®‰è£…å’Œä½¿ç”¨

### 1. ç¯å¢ƒå‡†å¤‡

**Pythonç¯å¢ƒ**:
```bash
pip install numpy matplotlib scikit-learn pandas
```

**Fortranç¼–è¯‘å™¨**:
- Linux: `sudo apt-get install gfortran`
- macOS: `brew install gcc`
- Windows: å®‰è£…MinGWæˆ–Intel Fortran

### 2. è®­ç»ƒPCEæ¨¡å‹

```bash
# ç”Ÿæˆè®­ç»ƒæ•°æ®
python data_generator.py

# è®­ç»ƒPCEæ¨¡å‹
python pce_trainer.py

# è¿è¡Œæ€§èƒ½å¯¹æ¯”
python pce_demo.py
```

### 3. ç¼–è¯‘å’Œè¿è¡ŒFortranç¨‹åº

```bash
# ç¼–è¯‘
make

# è¿è¡Œ
make run

# æ€§èƒ½æµ‹è¯•
make benchmark
```

## ğŸ“Š æ€§èƒ½å¯¹æ¯”

### ğŸš€ é€Ÿåº¦æ€§èƒ½
| æŒ‡æ ‡ | PCE | ç¥ç»ç½‘ç»œ | æå‡å€æ•° |
|------|-----|----------|----------|
| è®­ç»ƒé€Ÿåº¦ | 0.06s | 2.13s | **33.76x** |
| æ¨ç†é€Ÿåº¦ | 0.22s/1000æ¬¡ | 0.34s/1000æ¬¡ | **1.56x** |
| æ‰¹é‡ååé‡ | 312ä¸‡æ ·æœ¬/ç§’ | 200ä¸‡æ ·æœ¬/ç§’ | **1.56x** |
| å†…å­˜å ç”¨ | 6KB | 500KB+ | **83x** |

### ğŸ¯ ç²¾åº¦å¯¹æ¯”ï¼ˆåŸºäºå®é™…æµ‹è¯•ï¼‰
| å‡½æ•°ç±»å‹ | PCE RÂ² | ç¥ç»ç½‘ç»œ RÂ² | PCEè¡¨ç° | æ¨èä½¿ç”¨ |
|----------|--------|-------------|---------|----------|
| **å¤šé¡¹å¼å‡½æ•°** | **99.89%** | 99.66% | PCEæ›´ç²¾ç¡® | âœ… å¼ºçƒˆæ¨èPCE |
| **å¹³æ»‘éçº¿æ€§** | 96.42% | 98.96% | ç•¥ä½2.5% | âœ… æ¨èPCE |
| **å¤æ‚éçº¿æ€§** | 58.58% | 80.53% | ä½22% | âš–ï¸ éœ€è¦æƒè¡¡ |

### ğŸ“ˆ ç²¾åº¦vsé€Ÿåº¦æƒè¡¡
- **å¤šé¡¹å¼ç‰¹æ€§æ˜æ˜¾**: PCEç²¾åº¦æ›´é«˜ä¸”é€Ÿåº¦å¿«33å€ â†’ **å®Œç¾é€‰æ‹©**
- **å¹³æ»‘éçº¿æ€§å…³ç³»**: PCEç²¾åº¦ç•¥ä½ä½†é€Ÿåº¦å¿«33å€ â†’ **ä¼˜ç§€æƒè¡¡**
- **å¤æ‚éçº¿æ€§å…³ç³»**: PCEç²¾åº¦æ˜æ˜¾è¾ƒä½ â†’ **éœ€è¦è¯„ä¼°æ˜¯å¦å¯æ¥å—**

## ğŸ” è¯¦ç»†ç²¾åº¦åˆ†æ

### æµ‹è¯•æ–¹æ³•
æˆ‘ä»¬ä½¿ç”¨ä¸‰ç§ä¸åŒç±»å‹çš„å‡½æ•°æµ‹è¯•äº†PCEçš„ç²¾åº¦è¡¨ç°ï¼š

#### 1. å¤šé¡¹å¼å‡½æ•°æµ‹è¯•
```python
# çº¯2é˜¶å¤šé¡¹å¼å‡½æ•°
y = aâ‚€ + aâ‚xâ‚ + aâ‚‚xâ‚‚ + aâ‚ƒxâ‚Â² + aâ‚„xâ‚xâ‚‚ + aâ‚…xâ‚‚Â²
```
**ç»“æœ**: PCE RÂ² = **99.89%**, NN RÂ² = 99.66%
**ç»“è®º**: ğŸ† **PCEæ¯”ç¥ç»ç½‘ç»œæ›´ç²¾ç¡®ï¼**

#### 2. å¹³æ»‘éçº¿æ€§å‡½æ•°æµ‹è¯•
```python
# åŒ…å«ä¸‰è§’å‡½æ•°å’ŒæŒ‡æ•°å‡½æ•°çš„å¹³æ»‘å‡½æ•°
y = 0.5*sin(xâ‚)*cos(xâ‚‚) + 0.3*exp(-0.5*(xâ‚Â²+xâ‚‚Â²)) + 0.2*(xâ‚Â²+xâ‚‚Â²)
```
**ç»“æœ**: PCE RÂ² = 96.42%, NN RÂ² = 98.96%
**ç»“è®º**: âœ… **PCEç²¾åº¦ä¼˜ç§€ï¼Œä»…ä½2.5%**

#### 3. å¤æ‚éçº¿æ€§å‡½æ•°æµ‹è¯•
```python
# é«˜é¢‘æŒ¯è¡å’Œä¸è¿ç»­æ€§å‡½æ•°
y = sin(5Ï€xâ‚)*cos(3Ï€xâ‚‚) + tanh(10xâ‚xâ‚‚) + sign(xâ‚+xâ‚‚)*âˆš|xâ‚xâ‚‚|
```
**ç»“æœ**: PCE RÂ² = 58.58%, NN RÂ² = 80.53%
**ç»“è®º**: âš ï¸ **PCEç²¾åº¦æ˜æ˜¾è¾ƒä½ï¼Œå·®è·22%**

### ç²¾åº¦æå‡ç­–ç•¥
1. **å¢åŠ è®­ç»ƒæ•°æ®**: ä»1000å¢åŠ åˆ°5000+æ ·æœ¬
2. **ä½¿ç”¨é«˜é˜¶å¤šé¡¹å¼**: 3é˜¶æˆ–4é˜¶å±•å¼€ï¼ˆéœ€è¦æ›´å¤šåŸºå‡½æ•°ï¼‰
3. **æ•°æ®é¢„å¤„ç†**: æ ‡å‡†åŒ–ã€å»å™ªã€ç‰¹å¾å·¥ç¨‹
4. **åˆ†æ®µPCE**: å¯¹ä¸åŒè¾“å…¥åŒºåŸŸä½¿ç”¨ä¸åŒPCEæ¨¡å‹
5. **é›†æˆæ–¹æ³•**: å¤šä¸ªPCEæ¨¡å‹æŠ•ç¥¨å†³ç­–

### ä½•æ—¶é€‰æ‹©PCEï¼Ÿ
- **RÂ² > 90%**: ğŸ† PCEæ˜¯å®Œç¾é€‰æ‹©
- **80% < RÂ² < 90%**: âœ… PCEæ˜¯ä¼˜ç§€é€‰æ‹©
- **60% < RÂ² < 80%**: âš–ï¸ éœ€è¦æƒè¡¡ç²¾åº¦vsé€Ÿåº¦
- **RÂ² < 60%**: âŒ å»ºè®®ä½¿ç”¨ç¥ç»ç½‘ç»œ

## ğŸ”§ æŠ€æœ¯åŸç†

### PCEåŸºç¡€

PCEä½¿ç”¨å¤šé¡¹å¼åŸºå‡½æ•°æ¥è¿‘ä¼¼å¤æ‚çš„è¾“å…¥-è¾“å‡ºå…³ç³»ï¼š

```
y = Î£(i=0 to P) Î±áµ¢ * Î¨áµ¢(x)
```

å…¶ä¸­ï¼š
- `Î±áµ¢` æ˜¯PCEç³»æ•°
- `Î¨áµ¢(x)` æ˜¯å¤šé¡¹å¼åŸºå‡½æ•°
- `P` æ˜¯åŸºå‡½æ•°æ€»æ•°

### 2è¾“å…¥78è¾“å‡ºçš„PCEå®ç°

å¯¹äº2ç»´è¾“å…¥ï¼Œä½¿ç”¨2é˜¶å¤šé¡¹å¼å±•å¼€ï¼š

```fortran
! åŸºå‡½æ•°è®¡ç®—
phi(1) = 1.0d0        ! å¸¸æ•°é¡¹
phi(2) = x1           ! x1
phi(3) = x2           ! x2  
phi(4) = x1**2        ! x1Â²
phi(5) = x1 * x2      ! x1*x2
phi(6) = x2**2        ! x2Â²

! è¾“å‡ºè®¡ç®—
do i = 1, 78
   outputs(i) = sum(coeff(i,1:6) * phi(1:6))
enddo
```

## ğŸ“ˆ ä½¿ç”¨åœºæ™¯

### âœ… å¼ºçƒˆæ¨èPCEçš„åœºæ™¯ï¼ˆç²¾åº¦é«˜+é€Ÿåº¦å¿«ï¼‰ï¼š
- **å·¥ç¨‹ä»¿çœŸ**: ç»“æ„å“åº”ã€çƒ­ä¼ å¯¼ã€æµä½“åŠ›å­¦ç­‰ç‰©ç†ç°è±¡
- **æ§åˆ¶ç³»ç»Ÿ**: ç³»ç»Ÿå“åº”å‡½æ•°é€šå¸¸å…·æœ‰å¤šé¡¹å¼ç‰¹æ€§
- **ä¿¡å·å¤„ç†**: æ»¤æ³¢å™¨è®¾è®¡ã€é¢‘ç‡å“åº”è®¡ç®—
- **ææ–™ç§‘å­¦**: åº”åŠ›-åº”å˜å…³ç³»ã€ææ–™å±æ€§é¢„æµ‹
- **ä¼ æ„Ÿå™¨æ ¡å‡†**: ä¼ æ„Ÿå™¨å“åº”æ›²çº¿æ‹Ÿåˆ
- **å®æ—¶ä¼˜åŒ–**: éœ€è¦æ¯«ç§’çº§å“åº”çš„ä¼˜åŒ–é—®é¢˜

### âš–ï¸ éœ€è¦æƒè¡¡çš„åœºæ™¯ï¼ˆé€Ÿåº¦å¿«ä½†ç²¾åº¦å¯èƒ½ç•¥ä½ï¼‰ï¼š
- **é‡‘èå»ºæ¨¡**: å¦‚æœå¯¹ç²¾åº¦è¦æ±‚ä¸æ˜¯æé«˜
- **æ•°æ®æ‹Ÿåˆ**: å¹³æ»‘çš„éçº¿æ€§å…³ç³»
- **åµŒå…¥å¼AI**: è®¡ç®—èµ„æºå—é™ä½†éœ€è¦ä¸€å®šç²¾åº¦
- **å®æ—¶é¢„æµ‹**: é€Ÿåº¦æ¯”ç²¾åº¦æ›´é‡è¦çš„åœºæ™¯

### âŒ ä¸æ¨èPCEçš„åœºæ™¯ï¼š
- **å›¾åƒè¯†åˆ«**: é«˜åº¦éçº¿æ€§ï¼Œéœ€è¦å·ç§¯ç‰¹å¾
- **è‡ªç„¶è¯­è¨€å¤„ç†**: å¤æ‚è¯­ä¹‰å…³ç³»
- **å¤æ‚æ¨¡å¼è¯†åˆ«**: åŒ…å«å¤§é‡ä¸è¿ç»­æ€§
- **é«˜ç»´è¾“å…¥**: è¾“å…¥ç»´åº¦>10æ—¶åŸºå‡½æ•°æ•°é‡çˆ†ç‚¸
- **æé«˜ç²¾åº¦è¦æ±‚**: å¯¹ç²¾åº¦è¦æ±‚>95%çš„å…³é”®åº”ç”¨

## ğŸ”¬ ä»£ç ç¤ºä¾‹

### Pythonè®­ç»ƒç¤ºä¾‹

```python
from pce_trainer import PCETrainer

# åˆ›å»ºè®­ç»ƒå™¨
trainer = PCETrainer(input_dim=2, output_dim=78, polynomial_order=2)

# ç”Ÿæˆè®­ç»ƒæ•°æ®
X, Y = trainer.generate_training_data(n_samples=2000)

# è®­ç»ƒæ¨¡å‹
trainer.train(X, Y)

# ä¿å­˜æ¨¡å‹
trainer.save_model('my_pce_model.pkl')
trainer.export_fortran_coefficients('my_coefficients.txt')
```

### Fortranæ¨ç†ç¤ºä¾‹

```fortran
program my_pce_app
  implicit none
  
  real*8 :: inputs(2), outputs(78)
  
  ! è®¾ç½®è¾“å…¥
  inputs(1) = 0.5d0
  inputs(2) = -0.3d0
  
  ! PCEæ¨ç†
  call pce_forward(inputs, outputs)
  
  ! ä½¿ç”¨è¾“å‡ºç»“æœ
  print *, 'PCE Output:', outputs(1:5)
  
end program
```

## ğŸ¯ ä¼˜åŒ–å»ºè®®

### 1. æé«˜ç²¾åº¦
- å¢åŠ è®­ç»ƒæ•°æ®é‡
- ä½¿ç”¨æ›´é«˜é˜¶çš„å¤šé¡¹å¼
- ä¼˜åŒ–æ­£åˆ™åŒ–å‚æ•°

### 2. æé«˜é€Ÿåº¦
- ä½¿ç”¨ç¼–è¯‘å™¨ä¼˜åŒ–é€‰é¡¹ (`-O3`)
- è€ƒè™‘å¹¶è¡ŒåŒ–è®¡ç®—
- é¢„è®¡ç®—å¸¸ç”¨çš„åŸºå‡½æ•°å€¼

### 3. å‡å°‘å†…å­˜
- ä½¿ç”¨å•ç²¾åº¦æµ®ç‚¹æ•°
- å‹ç¼©ç³»æ•°çŸ©é˜µ
- åŠ¨æ€åŠ è½½ç³»æ•°

## ğŸ› æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

1. **ç¼–è¯‘é”™è¯¯**
   ```bash
   # æ£€æŸ¥ç¼–è¯‘å™¨ç‰ˆæœ¬
   gfortran --version
   
   # ä½¿ç”¨ä¸åŒç¼–è¯‘å™¨
   make FC=ifort
   ```

2. **ç²¾åº¦ä¸è¶³**
   ```python
   # å¢åŠ è®­ç»ƒæ•°æ®
   X, Y = trainer.generate_training_data(n_samples=5000)
   
   # è°ƒæ•´æ­£åˆ™åŒ–
   trainer.train(X, Y, regularization=1e-8)
   ```

3. **ç³»æ•°æ–‡ä»¶è¯»å–å¤±è´¥**
   ```fortran
   ! æ£€æŸ¥æ–‡ä»¶è·¯å¾„å’Œæ ¼å¼
   inquire(file='final_pce_coefficients.txt', exist=file_exists)
   ```

## ğŸ“š å‚è€ƒèµ„æ–™

- [Polynomial Chaos Expansion Theory](https://en.wikipedia.org/wiki/Polynomial_chaos)
- [Surrogate Modeling Techniques](https://doi.org/10.1016/j.cma.2019.112665)
- [PCE Applications in Engineering](https://doi.org/10.1016/j.jcp.2020.109382)

## ğŸ¤ è´¡çŒ®

æ¬¢è¿æäº¤Issueå’ŒPull Requestæ¥æ”¹è¿›è¿™ä¸ªé¡¹ç›®ï¼

## ğŸ“„ è®¸å¯è¯

MIT License - è¯¦è§LICENSEæ–‡ä»¶

---

## ğŸ‰ æ€»ç»“

### PCE vs ç¥ç»ç½‘ç»œ - æœ€ç»ˆå¯¹æ¯”

| æ–¹é¢ | PCE | ç¥ç»ç½‘ç»œ | èƒœè€… |
|------|-----|----------|------|
| **å¤šé¡¹å¼å‡½æ•°ç²¾åº¦** | 99.89% | 99.66% | ğŸ† **PCE** |
| **å¹³æ»‘éçº¿æ€§ç²¾åº¦** | 96.42% | 98.96% | NN (å·®è·å°) |
| **å¤æ‚éçº¿æ€§ç²¾åº¦** | 58.58% | 80.53% | NN (å·®è·å¤§) |
| **è®­ç»ƒé€Ÿåº¦** | 0.06s | 2.13s | ğŸ† **PCE (33å€)** |
| **æ¨ç†é€Ÿåº¦** | 0.22s | 0.34s | ğŸ† **PCE (1.6å€)** |
| **å†…å­˜å ç”¨** | 6KB | 500KB+ | ğŸ† **PCE (83å€)** |
| **å¯è§£é‡Šæ€§** | æ•°å­¦å…¬å¼ | é»‘ç›’ | ğŸ† **PCE** |
| **éƒ¨ç½²éš¾åº¦** | ç®€å• | å¤æ‚ | ğŸ† **PCE** |

### ğŸ¯ é€‰æ‹©å»ºè®®

**é€‰æ‹©PCEçš„æƒ…å†µ**:
- âœ… å·¥ç¨‹/ç‰©ç†ä»¿çœŸé—®é¢˜
- âœ… éœ€è¦å®æ—¶å“åº”ï¼ˆ<1msï¼‰
- âœ… åµŒå…¥å¼/èµ„æºå—é™ç¯å¢ƒ
- âœ… éœ€è¦æ•°å­¦å¯è§£é‡Šæ€§
- âœ… åº•å±‚å…³ç³»ç›¸å¯¹å¹³æ»‘

**é€‰æ‹©ç¥ç»ç½‘ç»œçš„æƒ…å†µ**:
- âœ… å›¾åƒ/è¯­éŸ³/æ–‡æœ¬å¤„ç†
- âœ… å¤æ‚æ¨¡å¼è¯†åˆ«
- âœ… å¯¹ç²¾åº¦è¦æ±‚æé«˜ï¼ˆ>95%ï¼‰
- âœ… é«˜ç»´è¾“å…¥ï¼ˆ>10ç»´ï¼‰
- âœ… éœ€è¦ç‰¹å¾å­¦ä¹ 

### ğŸš€ æ ¸å¿ƒä¼˜åŠ¿

PCEçš„æœ€å¤§ä»·å€¼åœ¨äºä¸º**å·¥ç¨‹å’Œç§‘å­¦è®¡ç®—**æä¾›äº†ä¸€ä¸ª**é«˜æ•ˆã€å¯è§£é‡Šã€æ˜“éƒ¨ç½²**çš„ç¥ç»ç½‘ç»œæ›¿ä»£æ–¹æ¡ˆã€‚åœ¨åˆé€‚çš„åº”ç”¨åœºæ™¯ä¸‹ï¼ŒPCEä¸ä»…é€Ÿåº¦æ›´å¿«ï¼Œç²¾åº¦ç”šè‡³å¯èƒ½æ›´é«˜ï¼

**æ³¨æ„**: è¿™ä¸ªå®ç°ä¸“é—¨é’ˆå¯¹2è¾“å…¥78è¾“å‡ºçš„é—®é¢˜è¿›è¡Œäº†ä¼˜åŒ–ã€‚å¦‚éœ€å¤„ç†å…¶ä»–ç»´åº¦çš„é—®é¢˜ï¼Œè¯·ç›¸åº”ä¿®æ”¹ä»£ç ä¸­çš„ç»´åº¦å‚æ•°ã€‚
